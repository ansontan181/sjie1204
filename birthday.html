<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‚âœ¨</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Zhi+Mang+Xing&display=swap" rel="stylesheet">
<style>
  :root{ --bg:#0c0f1a; --txt:#eef2ff; --gold:#ffd166; }
  *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
  html,body{height:100%}
  body{
    margin:0; color:var(--txt);
    background: radial-gradient(900px 600px at 20% 10%, #2a2f6d40, transparent 60%), linear-gradient(180deg,#0b1024,#090b17 70%, #0c0f1a);
    min-height:100svh; overflow:hidden; font-family: Montserrat, system-ui, -apple-system, Segoe UI, Roboto, PingFang SC, Microsoft YaHei, sans-serif;
  }
  #fw{position:fixed; inset:0; z-index:0; width:100vw; height:100dvh}
  .content{position:relative; z-index:2; min-height:100dvh; display:grid; place-items:center; padding: clamp(16px, 4vw, 40px)}
  .card{
    text-align:center; width:min(820px, 94vw); padding: clamp(20px, 5vw, 36px); border-radius:24px; backdrop-filter: blur(10px);
    background: linear-gradient(180deg, #ffffff12, #ffffff08); border: 1px solid #ffffff1a; box-shadow: 0 16px 44px #000a, inset 0 1px 0 #fff1;
  }
  .date{ font-size: clamp(12px, 3.2vw, 14px); letter-spacing:.18em; opacity:.75; margin-bottom:6px}
  h1{ font-weight:800; font-size: clamp(26px, 8vw, 42px); margin:4px 0 6px }
  .scribble{font-family:"Zhi Mang Xing", cursive; font-size: clamp(22px, 7.2vw, 38px); color:#ffd6a5; margin:6px 0 10px}
  p{margin:0 auto 14px; line-height:1.7; font-size: clamp(14px, 4vw, 17px); max-width:62ch; opacity:.95}
  .chips{display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:6px}
  .chip{padding:8px 12px; border-radius:999px; font-weight:700; font-size: clamp(12px,3.6vw,14px); background:#ffffff1a; border:1px solid #ffffff22}
  .actions{margin-top:14px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
  .btn{
    appearance:none; border:0; cursor:pointer; padding:12px 16px; border-radius:14px; font-weight:800; letter-spacing:.4px; font-size: clamp(14px, 4.4vw, 16px);
    background: linear-gradient(180deg, var(--gold), #ffb703); color:#3c2a00; box-shadow: 0 10px 22px #ffb70344, inset 0 -2px 0 #c98d00;
  }
  /* è§†é¢‘å¼¹å±‚ */
  .video-overlay{ position:fixed; inset:0; z-index:99; display:none; align-items:center; justify-content:center; background:#000;}
  .video-overlay.show{ display:flex; }
  .video-wrap{ position:relative; width:100vw; height:100dvh; display:flex; align-items:center; justify-content:center; }
  .video-wrap video{ max-width:100vw; max-height:100dvh; width:100vw; height:auto; object-fit:contain; background:#000; }
  .close-btn{
    position:fixed; top:12px; right:12px; z-index:100;
    padding:10px 14px; border-radius:12px; border:0; font-weight:900; font-size:14px; cursor:pointer;
    background: linear-gradient(180deg,#fff,#eaeaea); color:#111; box-shadow:0 10px 20px #0005, inset 0 -2px 0 #ccc;
  }

  /* å³ä¸‹å¿«æ·æŒ‰é’®ï¼ˆèƒ†å°å‹¿ç‚¹ä¸ç”Ÿæ—¥å¿«ä¹ï¼‰ */
  #scaryBtn{
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    padding: 12px 20px;
    font-size: 16px;
    font-weight: bold;
    color: white;
    background: red;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    z-index: 1000;
  }

  #scaryBox{
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    display: none;
    justify-content: center;
    align-items: center;
    background: black;
    z-index: 9999;
  }

  /* å³ä¸‹ æµ®åŠ¨å°æŒ‰é’®ï¼ˆä¿æŒå’ŒåŸé£æ ¼ç›¸è¿‘ï¼‰ */
  .float-btn {
    position: fixed;
    right: 22px;
    bottom: 22px;
    z-index: 1000;
    padding: 10px 14px;
    border-radius: 14px;
    background: linear-gradient(180deg,#b1ffd6,#b7eaff);
    box-shadow: 0 12px 26px #7ff2c744;
    font-weight:800;
    color:#0a2;
  }
</style>
</head>
<body>
  <!-- å…ˆæ¸²æŸ“ç»“æ„ï¼Œé˜²æ­¢ç™½å± -->
  <canvas id="fw"></canvas>
  <div class="content">
    <div class="card">
      <div class="date">2025 Â· 12 Â· 04</div>
      <h1>ç”Ÿæ—¥å¿«ä¹ï¼Œæ€æ·ï¼ğŸ‰</h1>
      <div class="scribble">æ„¿ä½ è¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…</div>
      <p>ä»Šå¤©å±äºä½ ï¼šæ„¿æ–°çš„ä¸€å²ï¼Œæ‰€å¿µçš†å¦‚æ„¿ï¼Œæ‰€è¡ŒåŒ–å¦é€”ã€‚æ„¿ä½ çœ¼é‡Œæ€»æœ‰å…‰ã€å¿ƒä¸­æ€»æœ‰çˆ±ï¼Œæƒ³è¦çš„éƒ½æ‹¥æœ‰ï¼Œå¾—ä¸åˆ°çš„éƒ½é‡Šæ€€ã€‚</p>
      <div class="chips">
        <div class="chip">ğŸ‚ Happy Birthday</div>
        <div class="chip">ğŸˆ æ°¸è¿œçƒ­çˆ±</div>
        <div class="chip">âœ¨ å¿ƒæƒ³äº‹æˆ</div>
        <div class="chip">ğŸ’ å¥åº·å¹³å®‰</div>
      </div>
      <div class="actions">
        <button class="btn" id="replay">å†æ”¾ä¸€æ³¢çƒŸèŠ±</button>
        <button class="btn" id="cakeBtn">ğŸ° æˆ‘æ„Ÿè§‰ä½ ä¼šæƒ³ææˆ‘</button>
        <!-- æ–°å¢ï¼šä¸ cakeBtn åŒä¸€è¡Œçš„ç”Ÿæ—¥å¿«ä¹æŒ‰é’® -->
        <button class="btn" id="exoBtn" style="background: linear-gradient(180deg,#84fab0,#8fd3f4); color:#001; box-shadow:0 10px 20px #84fab044, inset 0 -2px 0 #6ac5d6;">
          ğŸ‰ ç”Ÿæ—¥å¿«ä¹
        </button>
      </div>
    </div>
  </div>

<!-- èƒ†å°å‹¿ç‚¹æŒ‰é’® -->
<button id="scaryBtn">èƒ†å°å‹¿ç‚¹</button>

<!-- ç”¨æ¥æ˜¾ç¤ºå›¾ç‰‡ï¼ˆèƒ†å°å‹¿ç‚¹å¼¹å›¾ï¼‰ -->
<div id="scaryBox">
  <img id="scaryImg" src="" style="max-width:100%; max-height:100%; object-fit:contain;">
</div>

<script>
const scaryBtn = document.getElementById("scaryBtn");
const scaryBox = document.getElementById("scaryBox");
const scaryImg = document.getElementById("scaryImg");

scaryBtn.addEventListener("click", () => {
  scaryBox.style.display = "flex";
  
  // å…ˆæ˜¾ç¤º2.jpg æ’­æ”¾2.mp3
  scaryImg.src = "2.jpg";
  let audio = new Audio("2.mp3");
  audio.play();

  // 2ç§’ååˆ‡æ¢åˆ°3.jpg + 3.mp3
  setTimeout(() => {
    scaryImg.src = "3.jpg";
    let audio2 = new Audio("3.mp3");
    audio2.play();
  }, 2000);
});
</script>

  <!-- èƒŒæ™¯éŸ³ä¹ï¼šä¸é¢„è®¾ srcï¼Œä¸é»˜è®¤å¾ªç¯ï¼ŒæŒ‰é€»è¾‘åˆ‡æ¢ -->
  <audio id="bgm" preload="auto"></audio>

  <!-- è›‹ç³•è§†é¢‘å¼¹å±‚ï¼ˆåŸæœ‰ï¼‰ -->
  <div class="video-overlay" id="videoOverlay" role="dialog" aria-label="è›‹ç³•è§†é¢‘">
    <button class="close-btn" id="closeVideo">å…³é—­ âœ•</button>
    <div class="video-wrap">
      <video id="cakeVideo" src="2.mp4?v=highfix" playsinline webkit-playsinline controls preload="auto"></video>
    </div>
  </div>

  <!-- æ–°å¢ EXO è§†é¢‘å¼¹å±‚ -->
  <div class="video-overlay" id="exoOverlay" role="dialog" aria-label="EXOè§†é¢‘">
    <button class="close-btn" id="closeExo">å…³é—­ âœ•</button>
    <div class="video-wrap">
      <video id="exoVideo" src="exo.mp4" playsinline webkit-playsinline controls preload="auto"></video>
    </div>
  </div>

<script>
/* ========== æ‰€æœ‰ JS éƒ½åŒ… try/catchï¼Œé˜²æ­¢ç™½å± ========== */
try{
  // ç”»å¸ƒå°ºå¯¸
  const cvs = document.getElementById('fw'), ctx = cvs.getContext('2d');
  function fit(){
    const h = Math.max(window.innerHeight, window.visualViewport ? window.visualViewport.height : window.innerHeight);
    cvs.width = window.innerWidth; cvs.height = h;
  }
  addEventListener('resize', fit, {passive:true}); fit();
  let W=cvs.width, H=cvs.height;
  addEventListener('resize', ()=>{ W=cvs.width; H=cvs.height; }, {passive:true});

  // å·¥å…·ä¸çŠ¶æ€
  const rnd=(a,b)=>a+Math.random()*(b-a);
  const hsv=(h,s,v)=>{ let f=(n,k=(n+h/60)%6)=>v-v*s*Math.max(Math.min(k,4-k,1),0); return [f(5)*255,f(3)*255,f(1)*255]; };
  const rockets=[], particles=[], G=0.06, DRAG=0.985;

  function spawnRocket(x=rnd(W*0.25, W*0.75)){
    rockets.push({ x, y:H+12, vx:rnd(-0.7,0.7), vy:rnd(-12.5,-10.2), hue:rnd(0,360), bloom:rnd(140,220) });
  }
  function explode(x,y,hue,n){
    for (let i=0;i<n;i++){
      const a=Math.random()*Math.PI*2, s=Math.pow(Math.random(),0.25)*rnd(2.2,6.6);
      const [r,g,b]=hsv(hue+rnd(-14,14), .82, 1);
      particles.push({ x,y, vx:Math.cos(a)*s, vy:Math.sin(a)*s, life:rnd(70,120), age:0, r,g,b });
    }
  }
  function loop(){
    ctx.globalCompositeOperation='destination-out';
    ctx.fillStyle='rgba(0,0,0,0.22)'; ctx.fillRect(0,0,W,H);
    ctx.globalCompositeOperation='lighter';
    // ç«ç®­
    for (let i=rockets.length-1;i>=0;i--){
      const r=rockets[i];
      r.x+=r.vx; r.y+=r.vy; r.vy+=G*0.40;
      ctx.fillStyle='rgba(255,255,255,.75)'; ctx.fillRect(r.x, r.y, 2, 2);
      if (r.vy>-0.8 || r.y < H * rnd(0.12, 0.22)){ explode(r.x, r.y, r.hue, r.bloom); rockets.splice(i,1); }
    }
    // ç²’å­
    for (let i=particles.length-1;i>=0;i--){
      const p=particles[i];
      p.vx*=DRAG; p.vy=p.vy*DRAG+G; p.x+=p.vx; p.y+=p.vy; p.age++;
      const a=Math.max(0,1 - p.age/p.life);
      ctx.fillStyle=`rgba(${p.r|0},${p.g|0},${p.b|0},${a})`;
      ctx.beginPath(); ctx.arc(p.x,p.y,2,0,Math.PI*2); ctx.fill();
      if (p.age>p.life || p.y>H+16) particles.splice(i,1);
    }
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);

  // æ‰“å¼€å°±æœ‰çƒŸèŠ± + æŒç»­å‘å°„
  for (let i=0;i<4;i++) setTimeout(()=>spawnRocket(rnd(W*0.3,W*0.7)), i*180);
  setInterval(()=>spawnRocket(), 900);

  // äº¤äº’
  addEventListener('pointerdown', e=>{ for (let i=0;i<2;i++) spawnRocket(e.clientX); });
  const replayBtn=document.getElementById('replay');
  if (replayBtn){ replayBtn.addEventListener('click', ()=>{ for (let i=0;i<6;i++) setTimeout(()=>spawnRocket(), i*140); }); }

}catch(err){ console.error('Fireworks error:', err); }

try{
  // èƒŒæ™¯éŸ³ä¹é€»è¾‘ï¼š
  // è‹¥ä» index.html è·³å…¥ï¼ˆ?play=1ï¼‰ï¼Œå…ˆæ’­â€œæ€æ€.mp3â€ä¸€æ¬¡ï¼›ç»“æŸååˆ‡åˆ°â€œ1.mp3â€å¹¶å¾ªç¯ã€‚
  // å¦åˆ™ç›´æ¥å¾ªç¯â€œ1.mp3â€ã€‚
  const audio = document.getElementById('bgm');
  const qs = new URLSearchParams(location.search);
  const fromIndex = qs.get('play') === '1';

  const safePlay = () => audio && audio.play().catch(()=>{});

  if (fromIndex) {
    // å…ˆæ’­ æ€æ€.mp3 ä¸€æ¬¡
    audio.src  = "æ€æ€.mp3";
    audio.loop = false;

    const onFirstEnded = () => {
      audio.removeEventListener('ended', onFirstEnded);
      audio.src  = "1.mp3";
      audio.loop = true;
      safePlay();
    };
    audio.addEventListener('ended', onFirstEnded);

    // è§¦å‘æ’­æ”¾ï¼ˆç§»åŠ¨ç«¯éœ€è¦æ‰‹åŠ¿ï¼Œå·²ä» index ç‚¹è¿›æ¥é€šå¸¸å¯ç”¨ï¼‰
    setTimeout(safePlay, 0);
    addEventListener('pointerdown', safePlay, { once:true });
    addEventListener('visibilitychange', ()=>{ if(!document.hidden) safePlay(); });

  } else {
    // ç›´æ¥å¾ªç¯ 1.mp3
    audio.src  = "1.mp3";
    audio.loop = true;
    // ä¸å¼ºåˆ¶è‡ªåŠ¨æ’­æ”¾ï¼Œé¿å…æ— æ‰‹åŠ¿è¢«æµè§ˆå™¨æ‹¦æˆª
  }
}catch(err){ console.error('Audio error:', err); }

/* ====== è›‹ç³•è§†é¢‘å¼¹å±‚ï¼šç‚¹å‡»æ—¶ 2.mp4 ä¸ 5.mp3 åŒæ—¶æ’­æ”¾ ====== */
try{
  const cakeBtn    = document.getElementById('cakeBtn');
  const overlay    = document.getElementById('videoOverlay');
  const cakeVideo  = document.getElementById('cakeVideo');
  const closeVideo = document.getElementById('closeVideo');
  const bgm        = document.getElementById('bgm');

  let cakeBg = new Audio('5.mp3?v=highfix');

  if (cakeBtn && overlay && cakeVideo && closeVideo){
    cakeBtn.addEventListener('click', async () => {
      overlay.classList.add('show');
      try{ bgm.pause(); }catch(e){}

      try{
        cakeVideo.currentTime = 0;
        cakeBg.currentTime    = 0;
        await cakeVideo.play();
        await cakeBg.play();
      }catch(e){
        console.warn('Play error', e);
      }
    });

    function closeOverlay(){
      try{ cakeVideo.pause(); cakeVideo.currentTime = 0; }catch(e){}
      try{ cakeBg.pause();     cakeBg.currentTime    = 0; }catch(e){}
      overlay.classList.remove('show');
      setTimeout(()=>{ try{ bgm.play(); }catch(e){} }, 50);
    }

    closeVideo.addEventListener('click', closeOverlay);
    overlay.addEventListener('click', (e)=>{ if(e.target===overlay) closeOverlay(); });
    cakeVideo.addEventListener('ended', closeOverlay);
  }
}catch(err){ console.error('Video overlay error:', err); }

/* ====== EXO è§†é¢‘å¼¹å±‚é€»è¾‘ï¼ˆæ–°å¢ï¼‰ ====== */
try {
  const exoBtn = document.getElementById('exoBtn');
  const exoOverlay = document.getElementById('exoOverlay');
  const exoVideo = document.getElementById('exoVideo');
  const closeExo = document.getElementById('closeExo');
  const bgm = document.getElementById('bgm');

  if (exoBtn && exoOverlay && exoVideo && closeExo) {
    exoBtn.addEventListener('click', async () => {
      exoOverlay.classList.add('show');
      try { bgm.pause(); } catch (e) {}

      try {
        exoVideo.currentTime = 0;
        await exoVideo.play();
      } catch (e) {
        console.warn('æ’­æ”¾ exo.mp4 å¤±è´¥:', e);
      }
    });

    function closeExoOverlay() {
      try { exoVideo.pause(); exoVideo.currentTime = 0; } catch (e) {}
      exoOverlay.classList.remove('show');
      setTimeout(() => { try { bgm.play(); } catch (e) {} }, 50);
    }

    closeExo.addEventListener('click', closeExoOverlay);
    exoOverlay.addEventListener('click', e => { if (e.target === exoOverlay) closeExoOverlay(); });
    exoVideo.addEventListener('ended', closeExoOverlay);
  }
} catch (err) {
  console.error('EXOè§†é¢‘é€»è¾‘å‡ºé”™:', err);
}
</script>
</body>
</html>
